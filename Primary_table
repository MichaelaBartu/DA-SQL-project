SELECT
    cpc.name AS food_category, cpc.code, cp.value AS price,
    DATE_FORMAT(cp.date_from, '%Y'),
    cpib.name AS industry, cpib.code,
    cpay.value AS wages, 
    cpay.payroll_year
FROM czechia_price AS cp
JOIN czechia_payroll AS cpay
    ON YEAR(cp.date_from) = cpay.payroll_year AND
    cpay.value IS NOT NULL
JOIN czechia_price_category cpc
    ON cp.category_code = cpc.code
JOIN czechia_payroll_industry_branch cpib
    ON cpay.industry_branch_code = cpib.code
    WHERE cpay.payroll_year BETWEEN 2006 AND 2018
 ;
